<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Freeboard List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
          crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <script src="/js/header.js"></script>

  <style>
  
  </style>
  <script>
    $(document).ready(function () {
      $("#delete").on("click", function () {
        var checkArr = [];     // 배열 초기화
        $("input[name='deleteCheck']:checked").each(function(i) {
          checkArr.push($(this).val());     // 체크된 것만 값을 뽑아서 배열에 push
        })
        $.ajax({
          url: 'freeList',
          type: 'post',
          data: {
            valueArrTest: checkArr
          },
          success: function (data) {
            alert(data);
            if (data == "success") {
              location.reload();
            }
          },
          error: function () {
            alert("삭제 실패")
          }
        });
      });
    })
  </script>
</head>
<body>
<header th:replace="~{layout/header :: header-basic}"></header>

<main class="container my-4">
  <div class="row my-4">
    <div class="col-sm-2"></div>
    <div class="col-sm-8">
      <div class="row mt-5 mb-3">
        <div class="col-sm"><h2>자유게시판</h2></div>
        <div class="col-sm btn-group d-flex justify-content-end">
          <div class="form-check mx-3 form-check-inline">
            <input class="form-check-input" type="radio" name="radio" id="newest" value="newest" checked>
            <label class="form-check-label" for="newest">최신순</label>
          </div>
          <div class="form-check mx-3 form-check-inline">
            <input class="form-check-input" type="radio" name="radio" id="viewed" value="viewed">
            <label class="form-check-label" for="viewed">조회순</label>
          </div>
        </div>
      </div>
      <form action="/freeList" method="delete" id="form">
        <div>
          <table class="table table-hover text-center">
            <colgroup>
              <col style="width: 7%"/>
              <col style="width: 60%"/>
              <col style="width: 8%"/>
              <col style="width: 10%"/>
              <col style="width: 8%"/>
              <col th:if="${session.grade == '1'}" style="width: 7%"/>
            </colgroup>
            <thead>
            <tr class="table-secondary">
              <th>번호</th>
              <th class="text-start">제목</th>
              <th>글쓴이</th>
              <th>날짜</th>
              <th>조회수</th>
              <th th:if="${session.grade == '1'}">삭제</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.size(freeList)} > 0" th:each="free : ${freeList}">
              <td th:text="${free.idx}">100</td>
              <td class="text-start">
                <a href="/free/" th:attrappend="href=${free.idx}" th:text="${free.title}" class="text-decoration-none">됬으면 좋겠다</a>
              </td>
              <td th:text="${free.userName}">글쓴이</td>
              <td th:text="${free.createDt}">날짜~~</td>
              <td th:text="${free.hitCnt}">10</td>
              <td th:if="${session.grade == '1'}">
                <input class="form-check-input" type="checkbox" th:value="${free.idx}" name="deleteCheck">
              </td>
            </tr>
            <tr th:unless="${#lists.size(freeList)} > 0">
              <td colspan="6">조회된 데이터가 없습니다.</td>
            </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-end my-3">
            <a href="/freeWrite" class="btn btn-outline-primary mx-3" th:unless="${session.id == null}">글쓰기</a>
            <button type="button" class="btn btn-outline-danger" id="delete" th:if="${session.grade == '1'}">삭제</button>
          </div>
        </div>
<!--        <input type="hidden" id="method" name="_method">-->
      </form>
      <div class="container d-flex justify-content-center">
        <nav aria-label="Page navigation example">
          <ul class="pagination">
            <li class="page-item">
              <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            <li class="page-item"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item">
              <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
    <div class="col-sm-2"></div>
  </div>
</main>

<footer th:replace="~{layout/footer :: footer-basic}"></footer>
</body>
</html>